Make the tutor conversational, coherent, and lively.

1) Dialog policy
   - Implement a minimal conversation state machine: greet → understand → plan → teach → check → remediate/advance → close.
   - Add a tool schema `tutor_plan` with fields: goal, plan[], next_prompt, followup_options[].
   - On each turn, the LLM must call `tutor_plan`; UI speaks only `next_prompt`.

2) System prompt & params
   - Replace the system prompt with the text below (TutorMind rules).
   - Default model: gpt-4o (fallback gpt-4o-mini). Params: temperature 0.75, top_p 0.92, presence_penalty 0.3.
   - Enforce: reflect intent in one line; optionally ask a single clarifier.

   SYSTEM PROMPT:
   "You are “TutorMind,” a warm, upbeat, and encouraging coach...
   [paste the System prompt from above block verbatim]
   "

3) Voice & pacing
   - Azure TTS SSML wrapper with:
     voice: process.env.AZURE_VOICE_NAME || "en-US-EmmaMultilingualNeural"
     style: from ENERGY_LEVEL mapping (calm→"gentle", neutral→"friendly", upbeat→"cheerful")
     styledegree: 1.2; prosody rate +6%, pitch +1st.
   - Stream sentence-by-sentence; stop TTS immediately on mic input (barge-in).

4) Energy control
   - Env: ENERGY_LEVEL=calm|neutral|upbeat (default upbeat).
   - Provide a Settings UI toggle that updates session state and SSML mapping live.

5) Topic router
   - Add a light classifier tool `route_topic(text)` → math | grammar | reading | general.
   - Load a tiny domain prompt per topic (e.g., math: show one step then check; grammar: give example then ask student to try).

6) Repair moves & confirmations
   - If intent confidence is low, preface with one-line repair question offering two interpretations.
   - Keep responses ≤2 sentences; split longer ones into multiple TTS chunks.

7) Telemetry & sharing
   - Save text transcript per session (no audio) with timestamps and topic.
   - Add "Share session" button that copies a read-only link to the transcript (redact user PII).

8) Tests & docs
   - E2E tests: start session → ask ambiguous question → verify a repair question; ask clear question → verify short answer + question; barge-in stops TTS.
   - Update README: ENERGY_LEVEL, voice list, how to switch tone, how to export a transcript.
